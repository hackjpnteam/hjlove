<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google OAuthè¨­å®šç¢ºèªã‚¬ã‚¤ãƒ‰</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1a73e8;
            border-bottom: 3px solid #1a73e8;
            padding-bottom: 10px;
        }
        h2 {
            color: #333;
            margin-top: 30px;
            border-left: 4px solid #1a73e8;
            padding-left: 10px;
        }
        .step {
            background: #f8f9fa;
            border-left: 4px solid #34a853;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        button {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            background: #1557b0;
        }
        ul {
            line-height: 1.8;
        }
        .copy-btn {
            background: #34a853;
            padding: 5px 10px;
            font-size: 12px;
            margin-left: 10px;
        }
        img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Google OAuthè¨­å®šç¢ºèªã‚¬ã‚¤ãƒ‰</h1>
        
        <div class="error">
            <strong>ç¾åœ¨ã®ã‚¨ãƒ©ãƒ¼:</strong> "The given origin is not allowed for the given client ID"<br>
            ã“ã‚Œã¯Google Cloud Consoleã§ã®æ‰¿èªæ¸ˆã¿ã‚ªãƒªã‚¸ãƒ³è¨­å®šãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚
        </div>

        <h2>ğŸ“ ç¾åœ¨ã®ç’°å¢ƒæƒ…å ±</h2>
        <div class="step">
            <p><strong>ã‚ãªãŸã®ã‚ªãƒªã‚¸ãƒ³:</strong> <span id="current-origin"></span></p>
            <p><strong>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID:</strong> 770946554968-cf14im7fgm9ng8lmko4ltik2rns2udhb.apps.googleusercontent.com</p>
        </div>

        <h2>âœ… ã‚¹ãƒ†ãƒƒãƒ—1: Google Cloud Consoleã«ã‚¢ã‚¯ã‚»ã‚¹</h2>
        <div class="step">
            <ol>
                <li><a href="https://console.cloud.google.com/apis/credentials" target="_blank">Google Cloud Console - èªè¨¼æƒ…å ±ãƒšãƒ¼ã‚¸</a>ã‚’é–‹ã</li>
                <li>æ­£ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒé¸æŠã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆä¸Šéƒ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ç¢ºèªï¼‰</li>
                <li>ã€ŒOAuth 2.0 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ IDã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹</li>
                <li>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID <code>770946554968-cf14im7fgm9ng8lmko4ltik2rns2udhb...</code> ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            </ol>
        </div>

        <h2>âœ… ã‚¹ãƒ†ãƒƒãƒ—2: æ‰¿èªæ¸ˆã¿ã®JavaScriptç”Ÿæˆå…ƒã‚’è¿½åŠ </h2>
        <div class="step">
            <p>ã€Œ<strong>æ‰¿èªæ¸ˆã¿ã® JavaScript ç”Ÿæˆå…ƒ</strong>ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã®URLã‚’ã™ã¹ã¦è¿½åŠ ã—ã¦ãã ã•ã„ï¼š</p>
            <div class="code-block">
http://localhost:8000
http://localhost:3000
http://localhost:3001
http://127.0.0.1:8000
http://127.0.0.1:3000
http://127.0.0.1:3001
            </div>
            <button onclick="copyOrigins()">ğŸ“‹ URLã‚’ã‚³ãƒ”ãƒ¼</button>
            <div class="warning">
                <strong>æ³¨æ„:</strong> å„URLã¯åˆ¥ã€…ã®è¡Œã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚ã€ŒURIã‚’è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦1ã¤ãšã¤è¿½åŠ ã—ã¾ã™ã€‚
            </div>
        </div>

        <h2>âœ… ã‚¹ãƒ†ãƒƒãƒ—3: ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIã‚’è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h2>
        <div class="step">
            <p>ã€Œ<strong>æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URI</strong>ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š</p>
            <div class="code-block">
http://localhost:8000/auth-callback.html
http://localhost:3000/auth-callback.html
http://localhost:3001/auth-callback.html
            </div>
            <button onclick="copyRedirects()">ğŸ“‹ URIã‚’ã‚³ãƒ”ãƒ¼</button>
        </div>

        <h2>âœ… ã‚¹ãƒ†ãƒƒãƒ—4: ä¿å­˜ã—ã¦å¾…æ©Ÿ</h2>
        <div class="step">
            <ol>
                <li>ç”»é¢ä¸‹éƒ¨ã®ã€Œ<strong>ä¿å­˜</strong>ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>5-10åˆ†å¾…ã¤</strong>ï¼ˆGoogleå´ã§è¨­å®šãŒåæ˜ ã•ã‚Œã‚‹ã¾ã§æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ï¼‰</li>
                <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼ˆCmd+Shift+R ã¾ãŸã¯ Ctrl+Shift+Rï¼‰</li>
            </ol>
        </div>

        <h2>ğŸ§ª ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ†ã‚¹ãƒˆ</h2>
        <div class="step">
            <p>è¨­å®šãŒåæ˜ ã•ã‚ŒãŸã‚‰ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã§ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ï¼š</p>
            <ul>
                <li><a href="/google-simple-test.html">ã‚·ãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</a></li>
                <li><a href="/login.html">ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸</a></li>
                <li><a href="/google-test.html">è©³ç´°è¨ºæ–­ãƒšãƒ¼ã‚¸</a></li>
            </ul>
        </div>

        <h2>â“ ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–</h2>
        
        <div class="warning">
            <h3>å•é¡Œ: è¨­å®šã‚’ä¿å­˜ã—ãŸã®ã«ã¾ã ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹</h3>
            <ul>
                <li>Googleå´ã®åæ˜ ã«5-10åˆ†ã‹ã‹ã‚Šã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ãã ã•ã„ã€‚</li>
                <li>ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å®Œå…¨ã«é–‰ã˜ã¦å†èµ·å‹•ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</li>
                <li>ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ/ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</li>
            </ul>
        </div>

        <div class="warning">
            <h3>å•é¡Œ: "FedCM migration" ã®è­¦å‘ŠãŒå‡ºã‚‹</h3>
            <p>ã“ã‚Œã¯å°†æ¥çš„ãªå¤‰æ›´ã«é–¢ã™ã‚‹è­¦å‘Šã§ã€ç¾åœ¨ã®å‹•ä½œã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚ç„¡è¦–ã—ã¦æ§‹ã„ã¾ã›ã‚“ã€‚</p>
        </div>

        <div class="success">
            <h3>è¨­å®šãŒå®Œäº†ã—ãŸã‚‰</h3>
            <p>Googleèªè¨¼ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€Googleã®ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚</p>
        </div>

        <h2>ğŸ“ ç¾åœ¨ã®è¨­å®šçŠ¶æ…‹ã‚’ç¢ºèª</h2>
        <button onclick="testGoogleAuth()">Googleèªè¨¼ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <div id="test-result"></div>
    </div>

    <script>
        // Display current origin
        document.getElementById('current-origin').textContent = window.location.origin;

        function copyOrigins() {
            const origins = `http://localhost:8000
http://localhost:3000
http://localhost:3001
http://127.0.0.1:8000
http://127.0.0.1:3000
http://127.0.0.1:3001`;
            navigator.clipboard.writeText(origins);
            alert('æ‰¿èªæ¸ˆã¿JavaScriptç”Ÿæˆå…ƒã®URLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
        }

        function copyRedirects() {
            const redirects = `http://localhost:8000/auth-callback.html
http://localhost:3000/auth-callback.html
http://localhost:3001/auth-callback.html`;
            navigator.clipboard.writeText(redirects);
            alert('ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
        }

        function testGoogleAuth() {
            const resultDiv = document.getElementById('test-result');
            
            // Simple test to check if we can load Google library
            const script = document.createElement('script');
            script.src = 'https://accounts.google.com/gsi/client';
            script.onload = function() {
                resultDiv.innerHTML = '<div class="success">âœ… Google Sign-Inãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«æˆåŠŸã—ã¾ã—ãŸã€‚</div>';
                
                // Try to initialize
                if (window.google && window.google.accounts) {
                    try {
                        google.accounts.id.initialize({
                            client_id: '770946554968-cf14im7fgm9ng8lmko4ltik2rns2udhb.apps.googleusercontent.com',
                            callback: function(response) {
                                console.log('Auth response:', response);
                            }
                        });
                        resultDiv.innerHTML += '<div class="success">âœ… Google Sign-Inã®åˆæœŸåŒ–ã«æˆåŠŸã—ã¾ã—ãŸã€‚è¨­å®šã¯æ­£ã—ãåæ˜ ã•ã‚Œã¦ã„ã¾ã™ã€‚</div>';
                    } catch (error) {
                        resultDiv.innerHTML += '<div class="error">âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + error.message + '</div>';
                    }
                }
            };
            script.onerror = function() {
                resultDiv.innerHTML = '<div class="error">âŒ Google Sign-Inãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</div>';
            };
            document.head.appendChild(script);
        }
    </script>
</body>
</html>